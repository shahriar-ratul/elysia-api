// User model - End users of the application

model User {
  id                 BigInt    @id @default(autoincrement())
  firstName          String?   @map("first_name") @db.VarChar(100)
  lastName           String?   @map("last_name") @db.VarChar(100)
  phone              String?   @unique @db.VarChar(100)
  username           String?   @unique @db.VarChar(100)
  email              String    @unique @db.VarChar(255)
  password           String?   @db.VarChar(255)
  provider           String?   @db.VarChar(100)
  photo              String?   @db.VarChar(500)
  dob                DateTime? @db.Date
  joinedDate         DateTime  @default(dbgenerated("CURRENT_DATE")) @map("joined_date") @db.Date
  gender             String?   @db.VarChar(10)
  lastLogin          DateTime? @map("last_login") @db.Timestamptz(6)
  isVerified         Boolean   @default(false) @map("is_verified")
  verifiedAt         DateTime? @map("verified_at") @db.Timestamptz(6)
  verifiedByEmail    Boolean   @default(false) @map("verified_by_email")
  verifiedByPhone    Boolean   @default(false) @map("verified_by_phone")
  isActive           Boolean   @default(true) @map("is_active")
  isTrialing         Boolean   @default(false) @map("is_trialing")
  isPaid             Boolean   @default(false) @map("is_paid")
  premiumUntil       DateTime? @map("premium_until")
  createdBy          BigInt?   @map("created_by")
  updatedBy          BigInt?   @map("updated_by")
  isDeleted          Boolean   @default(false) @map("is_deleted")
  deletedAt          DateTime? @map("deleted_at") @db.Timestamptz(6)
  deletedBy          BigInt?   @map("deleted_by")
  deletedReason      String?   @map("deleted_reason") @db.VarChar(255)
  createdAt          DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt          DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)
  
  countryId          BigInt?   @map("country_id")

  // Relations
  country            Country?       @relation("UserCountryRelation", fields: [countryId], references: [id], onDelete: SetNull)
  createdByAdmin     Admin?         @relation("UserCreatedBy", fields: [createdBy], references: [id], onDelete: SetNull)
  updatedByAdmin     Admin?         @relation("UserUpdatedBy", fields: [updatedBy], references: [id], onDelete: SetNull)
  deletedByAdmin     Admin?         @relation("UserDeletedBy", fields: [deletedBy], references: [id], onDelete: SetNull)
  sessions           UserSession[]  @relation("UserSessions")
  sentEmailUsers     SentEmailUser[] @relation("UserSentEmails")
  auditLogs          AuditUserLog[] @relation("UserAuditLogs")

  @@index([isActive], map: "users_is_active_idx")
  @@index([isDeleted], map: "users_is_deleted_idx")
  @@index([isVerified], map: "users_is_verified_idx")
  @@index([email, isActive], map: "users_email_active_idx")
  @@index([createdBy], map: "users_created_by_idx")
  @@index([updatedBy], map: "users_updated_by_idx")
  @@index([deletedBy], map: "users_deleted_by_idx")
  @@index([countryId], map: "users_country_id_idx")
  @@map("users")
}
